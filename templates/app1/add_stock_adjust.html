{% extends 'app1/base.html' %}
{% block body %}
{% load static %}
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>






<style>
  input {
    background-color: #2f516f;
    border: 0;
    border-radius: 5px;
    color: white;
  }
</style>
<form action="create_stock_adjustment" method="post" class="needs-validation" enctype="multipart/form-data"  novalidate >{% csrf_token %}
        
    <div class="page-content">
        <h2 id="hel"></h2>
        <div class="card radius-15">
            <div class="card-body">
                <div class="card-title">
                    <center><h2 class="mb-0" id="estno">NEW ADJUSTMENT</h2></center>
                </div>
                <hr/>
            </div>
        </div>
        <div class="card radius-15">
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <!-- <center><h2>Fin sYs</h2></center> -->
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-3">
                     
                        <label for="validationCustom01"
                        style="color: white;">Mode of Adjustment</label>
                 <select name="mode" class="form-control" 
                           style="background-color: #2a4964; color: white;"
                           required>
                           <option selected disabled value="">Choose...</option>
                         <option value="Quandity">Quandity Adjustment</option>
                     <option value="Value">Value Adjustment</option></select>
                    </div>
                    
                    <div class="col-md-3"></div>
                    <div class="col-md-3"></div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-3">
                        <label class="col-form-label">Reference Number</label>
                   
                        <input class="form-control" type="text" id="bname" name="refno">
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-3 mt-2">
                        <label for="">Date *</label>
                        <input type="date" class="form-control" id="date" name="date" placeholder="">
                    </div>
                    
                    <div class="col-md-3">
                        <label class="col-form-label">Account *</label>
                        <select name="account" class="form-control" 
                           style="background-color: #2a4964; color: white;"
                           required>
                           <option selected disabled value="">Choose...</option>
                           {% for a in acc %}
                         <option value="{{ a.name }}">{{ a.name }}</option>
                         {% endfor %}
                    
                    </select>
                    
                    </div>
                    <div class="col-md-3 ">
                        <label class="col-form-label">Reason * </label>
                        <div class="d-flex">
                        <select name="reason" class="form-control" 
                        style="background-color: #2a4964; color: white;"
                        required>
                        <option selected disabled value="">Choose...</option>
                        {% for a in reason %}
                      <option value="{{ a.reason }}">{{ a.reason }}</option>
                      {% endfor %}
                      <option value="Stock on fire">Stock on fire</option>
                      <option value="Stolen goods">Stolen goods</option>
                      <option value="Damaged goods">Damaged goods</option>
                      <option value="Stock Written off">Stock Written off</option>
                      <option value="Inventory Revaluation">Inventory Revaluation</option>
                 
                 </select>
                 <a href="#">
                    <button type="button" class="btn btn-outline-secondary ml-1" 
                    data-target="#newreason" data-toggle="modal">+</button>
                </a>
            </div>
        </div>
    </div>
          <div class="row">
            <div class="col-md-3 mt-3">
              <label class="col-form-label">Description</label>
             <textarea name="desc" rows="5" class="form-control"  ></textarea>
            </div>
            <div class="col-md-3 mt-3"></div>
            <div class="col-md-3 mt-3"></div>
            <div class="col-md-3 mt-3"></div>
          </div>
          <div class="row clearfix">
            <div class="col-md-12 table-responsive-md mt-3">
              <table class="table table-bordered table-hover mt-3" id="tab_logic">
                <thead>
                  <tr id>
                    <th  class="text-center" >#</th>
                    <th class="text-center" >Item details</th>
                    <th class="text-center">Quandity Available</th>
                    <th class="text-center">New Quandity on hand</th>
                    <th class="text-center">Quandity Adjusted</th>
                    
                    
                  </tr>
                </thead>
                <tbody id="items-table-body">
                  <tr >
                    <td>1</td>
                    <td style="width: 20%;">

                        <div class="d-flex">
                            <select name="item1" id="itemss" class="form-control" style="background-color: #2f516f; color: white; ">
                                <option value=" " selected disabled>Select Product</option>
                                
                                {% for i in item %}
                                    <option 
                                            value="{{ i.name  }}">{{ i.name  }} </option>
                              
                            {% endfor %}
        
                              </select>

                        </div>
                      
                     
                    </td>
                    <td><input type="text"  id="qty" name="qty1"  class="form-control" style="background-color: #2f516f; color: white;text-align:right;" readonly></td>
                    <td><input type="text" id="qty_hand" name="qty_hand1" class="form-control" style="background-color: #2f516f; color: white;text-align:right;" /></td>
                    <td><input type="number"  id="qty1" name="new_qty1" class="form-control qty" style="background-color: #2f516f; color: white;" />
                
                    </td>
                  
                
                </tbody>
                <tr>
                    <td style="border: none;"><a class="btn btn-outline-secondary ml-1" role="button" id="addrow" >+</a></td>
                </tr>
              </table>

            </div>
          </div>
          <div class="row clearfix" style="margin-top:20px">
            <div class="col-md-6">

                <input type="file" name="file"  style="margin-top: 10px; width: 70%;">
            </div>

           
        </div>


        
          <div class="row">
            <div class="col-md-10 mt-3"></div>
            <div class="col-md-2 mt-3">
              <button type="submit" class="btn btn-outline-info rounded-pill w-100 text-grey pull-left">
                Save To Draft
              </button>
            </div>
          </div>
          <div class="notices mt-3">
            <div class="text-muted">NOTICE:</div>
            <div class="text-muted">
              Fin sYs Terms and Conditions Apply
            </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>
</form>








<!---------------------------------------------ADD REASON MODAL ----------------------------------------------->

<div class="modal fade" id="newreason">
    <div class="modal-dialog">
   
        <div class="modal-content" style="background-color: #213b52;">
            <form action="{% url 'create_reason' %}" method="post" class="needs-validation"  validate>
                {% csrf_token %}
            <div class="modal-header">
                <h3 class="m-3">Add Reason</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
              
              
                <div>
                    <div class="form-check">
                        <label class="form-check-label">Reason *</label> 
                        <input type="text" class="form-control" name="reason1">
                       
                    </div>

    
                </div>
           
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-outline-info" >Save</button>
                <button type="button" class="btn btn-outline-info" data-dismiss="modal">Close</button>
            </div>
        </form>
        </div>
 
    </div>
</div>            



<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>



            <script>
                $('#date').val(new Date().toJSON().slice(0,10));
            </script>


            <script>
                $(document).ready(function () {
                    $('#itemss').on('change', function () {
                        select = $('#itemss').val();
                        $.ajax({
                            type: "GET",
                            url: "{% url 'getit' %}",
                            data: {id: select}
                        }).done(function (response) {
                            var json_data = JSON.parse(response);
                            for (key in json_data) {
                                document.getElementById('qty').value = json_data[key]['stock']
                               
                            }
                        }).fail(function () {
                            alert("failed");
                        })
                    })
                })
            </script>
       
{% endblock %}
